# Havamania Gorev Plani (Task Breakdown)

Not: Her gorev tek bir net cikti uretir.  
Format: `ID - Gorev (Bagimlilik)`

## A) Proje Hazirligi ve Monorepo Kurulumu
- [x] T-001 - `backend/`, `mobile/`, `docs/` klasorlerini olustur (Bagimlilik: yok)
- [x] T-002 - `backend/README.md` olustur (Bagimlilik: T-001)
- [x] T-003 - `mobile/README.md` olustur (Bagimlilik: T-001)
- [x] T-004 - kok dizine genel `README.md` olustur (Bagimlilik: T-001)
- [x] T-005 - `.gitignore` icine Python/Node/IDE kurallarini ekle (Bagimlilik: T-001)
- [x] T-006 - `docs/prd.md` kopyasini/yonlendirmesini ekle (Bagimlilik: T-001)
- [x] T-007 - `docs/architect.md` kopyasini/yonlendirmesini ekle (Bagimlilik: T-001)
- [x] T-008 - `docs/task.md` kopyasini/yonlendirmesini ekle (Bagimlilik: T-001)
- [x] T-009 - backend icin `pyproject.toml` olustur (Bagimlilik: T-001)
- [x] T-010 - backend icin temel bagimliliklari ekle (FastAPI, Uvicorn, SQLAlchemy, Alembic) (Bagimlilik: T-009)
- [x] T-011 - mobile icin `package.json` olustur (Bagimlilik: T-001)
- [x] T-012 - mobile temel bagimliliklarini ekle (React Native, Navigation, React Query) (Bagimlilik: T-011)
- [x] T-013 - kok dizinde `.editorconfig` olustur (Bagimlilik: T-001)
- [x] T-014 - kok dizinde `Makefile` veya script komutlari tanimla (Bagimlilik: T-009, T-011)
- [x] T-015 - ortam degiskenleri icin `.env.example` olustur (Bagimlilik: T-009)

## B) Backend Iskeleti
- [x] T-016 - `backend/app/main.py` olustur (Bagimlilik: T-010)
- [x] T-017 - health endpoint (`GET /health`) ekle (Bagimlilik: T-016)
- [x] T-018 - `backend/app/core/config.py` ile ayar yonetimini ekle (Bagimlilik: T-016)
- [x] T-019 - loglama altyapisini ekle (Bagimlilik: T-016)
- [x] T-020 - CORS ayarlarini ekle (Bagimlilik: T-016)
- [x] T-021 - `backend/app/db/session.py` olustur (Bagimlilik: T-010)
- [x] T-022 - SQLAlchemy Base tanimini ekle (Bagimlilik: T-021)
- [x] T-023 - Alembic init ve ayar dosyalarini olustur (Bagimlilik: T-010, T-021)
- [ ] T-024 - ilk migration calisir hale getir (Bagimlilik: T-023)
- [x] T-025 - `api/v1` router yapisini olustur (Bagimlilik: T-016)
- [x] T-026 - global exception handler ekle (Bagimlilik: T-016)
- [x] T-027 - request id middleware ekle (Bagimlilik: T-016)
- [x] T-028 - rate limit middleware iskeleti ekle (Bagimlilik: T-016)

## C) Kimlik Dogrulama (Auth)
- [x] T-029 - `users` tablosu modelini olustur (Bagimlilik: T-022)
- [x] T-030 - `users` migration dosyasini yaz (Bagimlilik: T-029, T-023)
- [x] T-031 - password hash util fonksiyonlarini yaz (Bagimlilik: T-010)
- [x] T-032 - JWT olusturma/dogrulama utilini yaz (Bagimlilik: T-010)
- [x] T-033 - signup request/response schema yaz (Bagimlilik: T-025)
- [x] T-034 - login request/response schema yaz (Bagimlilik: T-025)
- [x] T-035 - `POST /v1/auth/signup` endpointini yaz (Bagimlilik: T-029, T-031, T-033)
- [x] T-036 - `POST /v1/auth/login` endpointini yaz (Bagimlilik: T-029, T-031, T-032, T-034)
- [x] T-037 - refresh token modeli/tablosunu ekle (Bagimlilik: T-022)
- [x] T-038 - refresh token migration yaz (Bagimlilik: T-037, T-023)
- [x] T-039 - `POST /v1/auth/refresh` endpointini yaz (Bagimlilik: T-032, T-037)
- [x] T-040 - `POST /v1/auth/logout` endpointini yaz (Bagimlilik: T-037)
- [x] T-041 - auth dependency (`get_current_user`) yaz (Bagimlilik: T-032)
- [x] T-042 - auth endpoint unit testlerini yaz (Bagimlilik: T-035, T-036, T-039, T-040)

## D) Profil, Konum ve Tercihler
- [x] T-043 - `profiles` tablosu modelini olustur (Bagimlilik: T-022, T-029)
- [x] T-044 - `locations` tablosu modelini olustur (Bagimlilik: T-022, T-029)
- [x] T-045 - `notification_preferences` tablosu modelini olustur (Bagimlilik: T-022, T-029)
- [x] T-046 - bu uc tablo icin migration yaz (Bagimlilik: T-043, T-044, T-045, T-023)
- [x] T-047 - profile schema dosyalarini yaz (Bagimlilik: T-025)
- [x] T-048 - location schema dosyalarini yaz (Bagimlilik: T-025)
- [x] T-049 - notification preference schema dosyalarini yaz (Bagimlilik: T-025)
- [x] T-050 - `GET /v1/profile` endpointini yaz (Bagimlilik: T-043, T-041, T-047)
- [x] T-051 - `PATCH /v1/profile` endpointini yaz (Bagimlilik: T-043, T-041, T-047)
- [x] T-052 - `GET /v1/profile/locations` endpointini yaz (Bagimlilik: T-044, T-041, T-048)
- [x] T-053 - `POST /v1/profile/locations` endpointini yaz (Bagimlilik: T-044, T-041, T-048)
- [x] T-054 - `PATCH /v1/profile/locations/{id}` endpointini yaz (Bagimlilik: T-044, T-041, T-048)
- [x] T-055 - `DELETE /v1/profile/locations/{id}` endpointini yaz (Bagimlilik: T-044, T-041)
- [x] T-056 - `GET /v1/profile/notifications` endpointini yaz (Bagimlilik: T-045, T-041, T-049)
- [x] T-057 - `PATCH /v1/profile/notifications` endpointini yaz (Bagimlilik: T-045, T-041, T-049)
- [x] T-058 - birincil konum tekillik kontrolunu ekle (Bagimlilik: T-044, T-053, T-054)
- [x] T-059 - profil endpoint entegrasyon testlerini yaz (Bagimlilik: T-050-T-057)

## E) Hava Durumu Servisi
- [x] T-060 - WeatherProvider arayuzunu tanimla (Bagimlilik: T-016)
- [x] T-061 - OpenMeteo provider sinifini olustur (Bagimlilik: T-060)
- [x] T-062 - provider HTTP client timeout/retry ayarlarini yaz (Bagimlilik: T-061)
- [x] T-063 - weather response normalize mapper yaz (Bagimlilik: T-061)
- [x] T-064 - `weather_snapshots` modelini olustur (Bagimlilik: T-022)
- [x] T-065 - `weather_snapshots` migration yaz (Bagimlilik: T-064, T-023)
- [x] T-066 - cache katmani (Redis) adapterini ekle (Bagimlilik: T-016)
- [x] T-067 - current weather use-case yaz (Bagimlilik: T-061, T-063, T-066)
- [x] T-068 - hourly weather use-case yaz (Bagimlilik: T-061, T-063, T-066)
- [x] T-069 - daily weather use-case yaz (Bagimlilik: T-061, T-063, T-066)
- [x] T-070 - `GET /v1/weather/current` endpointini yaz (Bagimlilik: T-067)
- [x] T-071 - `GET /v1/weather/hourly` endpointini yaz (Bagimlilik: T-068)
- [x] T-072 - `GET /v1/weather/daily` endpointini yaz (Bagimlilik: T-069)
- [x] T-073 - hava endpointleri icin input validation ekle (Bagimlilik: T-070, T-071, T-072)
- [x] T-074 - hava endpointlerine rate limit uygula (Bagimlilik: T-028, T-070, T-071, T-072)
- [x] T-075 - weather provider fallback mekanizmasini ekle (Bagimlilik: T-060)
- [x] T-076 - provider secimini feature flag ile yonet (Bagimlilik: T-075)
- [x] T-077 - weather servis unit testlerini yaz (Bagimlilik: T-067-T-069)
- [x] T-078 - weather endpoint entegrasyon testlerini yaz (Bagimlilik: T-070-T-072)

## F) Uyarilar (Alerts)
- [x] T-079 - `alerts` modelini olustur (Bagimlilik: T-022, T-044)
- [x] T-080 - `alerts` migration yaz (Bagimlilik: T-079, T-023)
- [x] T-081 - alert severity enumunu tanimla (Bagimlilik: T-079)
- [x] T-082 - alert schema dosyalarini yaz (Bagimlilik: T-025)
- [x] T-083 - `GET /v1/alerts` endpointini yaz (Bagimlilik: T-079, T-082, T-041)
- [x] T-084 - `GET /v1/alerts/{id}` endpointini yaz (Bagimlilik: T-079, T-082, T-041)
- [x] T-085 - cron/job ile dis kaynaktan alert cekme iskeletini yaz (Bagimlilik: T-079)
- [x] T-086 - kritik/aktif gruplama logicini backend'e ekle (Bagimlilik: T-083)
- [x] T-087 - alert endpoint testlerini yaz (Bagimlilik: T-083, T-084)

## G) Chatbot Entegrasyonu
- [x] T-088 - chatbot bridge config ayarlarini ekle (Bagimlilik: T-018)
- [x] T-089 - chatbot bridge HTTP client olustur (Bagimlilik: T-088)
- [x] T-090 - chatbot request/response schema yaz (Bagimlilik: T-025)
- [x] T-091 - `chatbot_usage_daily` modelini olustur (Bagimlilik: T-022, T-029)
- [x] T-092 - `chatbot_usage_daily` migration yaz (Bagimlilik: T-091, T-023)
- [x] T-093 - gunluk kullanim sayaç servis yaz (Bagimlilik: T-091)
- [x] T-094 - free plan gunluk limit sabitini tanimla (Bagimlilik: T-018)
- [x] T-095 - premium limit kurallarini tanimla (Bagimlilik: T-094)
- [x] T-096 - `POST /v1/chatbot/ask` endpointini yaz (Bagimlilik: T-089, T-090, T-093, T-041)
- [x] T-097 - `GET /v1/chatbot/usage` endpointini yaz (Bagimlilik: T-093, T-041)
- [x] T-098 - timeout/retry/fallback mesaj davranisini ekle (Bagimlilik: T-096)
- [x] T-099 - chatbot endpoint testlerini yaz (Bagimlilik: T-096, T-097)

## H) Abonelik ve Paywall
- [x] T-100 - `subscriptions` modelini olustur (Bagimlilik: T-022, T-029)
- [x] T-101 - `subscriptions` migration yaz (Bagimlilik: T-100, T-023)
- [x] T-102 - plan kodlarini (`free`, `premium_monthly`, `premium_yearly`) tanimla (Bagimlilik: T-100)
- [x] T-103 - subscription status servis yaz (Bagimlilik: T-100)
- [x] T-104 - receipt validation adaptor arayuzunu yaz (Bagimlilik: T-016)
- [x] T-105 - iOS receipt validation adaptor iskeletini yaz (Bagimlilik: T-104)
- [x] T-106 - Android purchase token validation adaptor iskeletini yaz (Bagimlilik: T-104)
- [x] T-107 - `POST /v1/subscription/validate-receipt` endpointini yaz (Bagimlilik: T-103, T-105, T-106, T-041)
- [x] T-108 - `GET /v1/subscription/status` endpointini yaz (Bagimlilik: T-103, T-041)
- [x] T-109 - store webhook endpointini yaz (Bagimlilik: T-103)
- [x] T-110 - premium endpoint guard dependency yaz (Bagimlilik: T-103, T-041)
- [x] T-111 - premium weather katmani endpointine guard uygula (Bagimlilik: T-110, T-070-T-072)
- [x] T-112 - premium chatbot limitlerini guard ile bagla (Bagimlilik: T-110, T-096)
- [x] T-113 - abonelik iptal/grace durumlarina gore erisim kurali ekle (Bagimlilik: T-103)
- [x] T-114 - subscription testlerini yaz (Bagimlilik: T-107, T-108, T-109)

## I) Push ve Bildirim
- [x] T-115 - push token saklama tablosunu olustur (Bagimlilik: T-022, T-029)
- [x] T-116 - push token migration yaz (Bagimlilik: T-115, T-023)
- [x] T-117 - `POST /v1/devices/push-token` endpointini yaz (Bagimlilik: T-115, T-041)
- [x] T-118 - FCM/APNs adapter iskeletini yaz (Bagimlilik: T-016)
- [x] T-119 - kritik alert olusunca push gonderen servis yaz (Bagimlilik: T-079, T-118)
- [x] T-120 - kullanici notification preference kontrolu ekle (Bagimlilik: T-045, T-119)
- [x] T-121 - push servis testlerini yaz (Bagimlilik: T-119, T-120)

## J) Mobil Altyapi (React Native)
- [x] T-122 - React Native projesini init et (Bagimlilik: T-011, T-012)
- [x] T-123 - TypeScript config ayarlarini tamamla (Bagimlilik: T-122)
- [x] T-124 - ESLint/Prettier ayarlarini ekle (Bagimlilik: T-122)
- [x] T-125 - temel klasor yapisini olustur (`src/screens`, `src/services`, `src/store`) (Bagimlilik: T-122)
- [x] T-126 - navigation altyapisini kur (Bagimlilik: T-122)
- [x] T-127 - bottom tab yapisini kur (Home, Map, Alerts, Settings) (Bagimlilik: T-126)
- [x] T-128 - auth stack yapisini kur (Login, Signup) (Bagimlilik: T-126)
- [x] T-129 - API client (axios/fetch wrapper) ekle (Bagimlilik: T-122)
- [x] T-130 - auth token storage (secure storage) ekle (Bagimlilik: T-129)
- [x] T-131 - React Query provider kur (Bagimlilik: T-122)
- [x] T-132 - global theme state kur (Bagimlilik: T-122)
- [x] T-133 - i18n temel altyapiyi ekle (TR varsayilan) (Bagimlilik: T-122)
- [x] T-134 - error boundary ve global toast mekanizmasi ekle (Bagimlilik: T-122)

## K) Mobil Auth Ekranlari
- [x] T-135 - Login ekranini verilen taslaga yakin sekilde uygula (Bagimlilik: T-128)
- [x] T-136 - SignUp ekranini verilen taslaga yakin sekilde uygula (Bagimlilik: T-128)
- [x] T-137 - Login form validasyonunu ekle (Bagimlilik: T-135)
- [x] T-138 - SignUp form validasyonunu ekle (Bagimlilik: T-136)
- [x] T-139 - signup API entegrasyonunu bagla (Bagimlilik: T-035, T-136, T-129)
- [x] T-140 - login API entegrasyonunu bagla (Bagimlilik: T-036, T-135, T-129)
- [x] T-141 - refresh token akisini mobilde uygula (Bagimlilik: T-039, T-130)
- [x] T-142 - logout akisini mobilde uygula (Bagimlilik: T-040, T-130)

## L) Mobil Home Ekrani
- [x] T-143 - Home ekran temel layoutunu uygula (Bagimlilik: T-127)
- [x] T-144 - current weather kartini bagla (Bagimlilik: T-070, T-143, T-129)
- [x] T-145 - 24 saatlik tahmin listesini bagla (Bagimlilik: T-071, T-143, T-129)
- [x] T-146 - 7 gunluk tahmin listesini bagla (Bagimlilik: T-072, T-143, T-129)
- [x] T-147 - metrik kartlarini normalize veriyle doldur (Bagimlilik: T-070, T-143)
- [x] T-148 - loading/skeleton state ekle (Bagimlilik: T-144, T-145, T-146)
- [x] T-149 - hata durumunda yeniden dene butonu ekle (Bagimlilik: T-144, T-145, T-146)
- [x] T-150 - pull-to-refresh davranisini ekle (Bagimlilik: T-144, T-145, T-146)

## M) Mobil Harita Ekrani
- [x] T-151 - Map ekran temel layoutunu uygula (Bagimlilik: T-127)
- [x] T-152 - konum izni isteme akisini ekle (Bagimlilik: T-151)
- [x] T-153 - "my location" butonunu gercek GPS ile bagla (Bagimlilik: T-152)
- [x] T-154 - katman secim UI'sini uygula (Bagimlilik: T-151)
- [x] T-155 - harita katmani verisini backend endpointine bagla (Bagimlilik: T-070, T-151)
- [x] T-156 - timeline slider state yonetimini ekle (Bagimlilik: T-151)
- [x] T-157 - premium katman seciminde paywall tetigi ekle (Bagimlilik: T-108, T-110, T-154)

## N) Mobil Uyarilar Ekrani
- [x] T-158 - Alerts ekran temel layoutunu uygula (Bagimlilik: T-127)
- [x] T-159 - `GET /alerts` entegrasyonunu yap (Bagimlilik: T-083, T-158, T-129)
- [x] T-160 - kritik/aktif gruplamayi UI'da goster (Bagimlilik: T-159)
- [x] T-161 - alert detay drawer/modal ekle (Bagimlilik: T-084, T-158)
- [x] T-162 - filtreleme (severity, konum) ekle (Bagimlilik: T-159)
- [x] T-163 - bos durum tasarimini ekle (Bagimlilik: T-159)

## O) Mobil Profil ve Ayarlar
- [x] T-164 - Settings/Profile ekran temel layoutunu uygula (Bagimlilik: T-127)
- [x] T-165 - profil kartini `GET /profile` ile bagla (Bagimlilik: T-050, T-164, T-129)
- [x] T-166 - tema secimini global state ile bagla (Bagimlilik: T-132, T-164)
- [x] T-167 - birim secimlerini `PATCH /profile` ile kaydet (Bagimlilik: T-051, T-164)
- [x] T-168 - bildirim tercihlerini `PATCH /profile/notifications` ile kaydet (Bagimlilik: T-057, T-164)
- [x] T-169 - konum listesi alt ekranini olustur (Bagimlilik: T-164)
- [x] T-170 - konum ekleme formunu bagla (Bagimlilik: T-053, T-169, T-129)
- [x] T-171 - konum duzenleme/silme akislarini bagla (Bagimlilik: T-054, T-055, T-169, T-129)
- [x] T-172 - "konum bazli takip" ac/kapat kontrolunu ekle (Bagimlilik: T-054, T-169)
- [x] T-173 - premium konum limiti kontrolu + paywall tetigi ekle (Bagimlilik: T-108, T-110, T-170)

## P) Mobil Chatbot
- [x] T-174 - chatbot ekranini olustur (Bagimlilik: T-127)
- [x] T-175 - mesaj listesi ve giris kutusu UI'sini ekle (Bagimlilik: T-174)
- [x] T-176 - `POST /chatbot/ask` entegrasyonunu yap (Bagimlilik: T-096, T-174, T-129)
- [x] T-177 - `GET /chatbot/usage` ile kalan limit gostergesi ekle (Bagimlilik: T-097, T-174, T-129)
- [x] T-178 - limit asiminda paywall veya bilgilendirme modali goster (Bagimlilik: T-176, T-108)
- [x] T-179 - yanit gecikmesi icin loading/timeout UX ekle (Bagimlilik: T-176)

## Q) Abonelik UI ve Satin Alma Akisi
- [x] T-180 - paywall ekranini olustur (Bagimlilik: T-127)
- [x] T-181 - plan kartlarini olustur (aylik/yillik) (Bagimlilik: T-180)
- [x] T-182 - in-app purchase SDK kurulumunu yap (Bagimlilik: T-122)
- [x] T-183 - satin alma butonunu SDK ile bagla (Bagimlilik: T-182, T-181)
- [x] T-184 - satin alma sonucu receipt'i backend'e gonder (Bagimlilik: T-107, T-183)
- [x] T-185 - `GET /subscription/status` ile UI senkronizasyonu yap (Bagimlilik: T-108, T-180)
- [x] T-186 - premium badge ve kilitli ozellik gostergelerini ekle (Bagimlilik: T-185)
- [x] T-187 - restore purchases akisini ekle (Bagimlilik: T-182, T-184)

## R) Test ve Kalite
- [x] T-188 - backend unit test altyapisini kur (pytest) (Bagimlilik: T-010)
- [x] T-189 - backend integration test altyapisini kur (test db) (Bagimlilik: T-188, T-021)
- [x] T-190 - auth testlerini otomasyona bagla (Bagimlilik: T-042)
- [x] T-191 - profile testlerini otomasyona bagla (Bagimlilik: T-059)
- [x] T-192 - weather testlerini otomasyona bagla (Bagimlilik: T-077, T-078)
- [x] T-193 - alert testlerini otomasyona bagla (Bagimlilik: T-087)
- [x] T-194 - chatbot testlerini otomasyona bagla (Bagimlilik: T-099)
- [x] T-195 - subscription testlerini otomasyona bagla (Bagimlilik: T-114)
- [x] T-196 - mobile unit test altyapisini kur (Jest/RTL) (Bagimlilik: T-122)
- [x] T-197 - mobile ekran smoke testlerini yaz (Bagimlilik: T-135, T-143, T-151, T-158, T-164)
- [x] T-198 - e2e test altyapisini kur (Detox/Appium) (Bagimlilik: T-122)
- [x] T-199 - onboarding->login->home e2e testini yaz (Bagimlilik: T-198, T-140, T-144)
- [x] T-200 - profile preference kaydetme e2e testini yaz (Bagimlilik: T-198, T-167, T-168)
- [x] T-201 - premium satin alma mock e2e testini yaz (Bagimlilik: T-198, T-184)

## S) CI/CD, Gozlemlenebilirlik ve Release
- [x] T-202 - backend icin CI pipeline olustur (lint + test) (Bagimlilik: T-188)
- [x] T-203 - mobile icin CI pipeline olustur (lint + test) (Bagimlilik: T-196)
- [x] T-204 - Dockerfile (backend) yaz (Bagimlilik: T-016)
- [x] T-205 - staging ortamini ayakta kaldir (Bagimlilik: T-204)
- [x] T-206 - production ortam secret yonetimini yap (Bagimlilik: T-205)
- [x] T-207 - Sentry entegrasyonunu backend'e ekle (Bagimlilik: T-016)
- [x] T-208 - Sentry entegrasyonunu mobile'a ekle (Bagimlilik: T-122)
- [x] T-209 - metrik endpoint ve dashboard panellerini olustur (Bagimlilik: T-019)
- [x] T-210 - API p95 gecikme alarmini tanimla (Bagimlilik: T-209)
- [x] T-211 - provider hata orani alarmini tanimla (Bagimlilik: T-209)
- [x] T-212 - release checklist dokumani olustur (Bagimlilik: T-202, T-203)
- [ ] T-213 - TestFlight internal dagitimini al (Bagimlilik: T-212)
- [ ] T-214 - Android internal testing dagitimini al (Bagimlilik: T-212)
- [ ] T-215 - MVP go-live karari icin metrik kontrol toplantisini yap (Bagimlilik: T-213, T-214)

## T) MVP Cikis Kapilari
- [ ] T-216 - kritik bug sayisini "0 blocker" seviyesine indir (Bagimlilik: T-188-T-215)
- [ ] T-217 - performans hedeflerini dogrula (p95 < 400ms) (Bagimlilik: T-209)
- [ ] T-218 - free/premium ozellik ayriminin tum ekranlarda dogru oldugunu dogrula (Bagimlilik: T-157, T-173, T-178, T-186)
- [ ] T-219 - UX hizli kullanim testi (5 kullanici) tamamla (Bagimlilik: T-143, T-151, T-158, T-164)
- [ ] T-220 - MVP release notlarini yayinla (Bagimlilik: T-216-T-219)

## U) Proje Çalıştırma (Runtime)
- [x] R-001 - Ortam dosyalarını (`.env`) oluştur (Bağımlılık: yok)
- [x] R-002 - PostgreSQL veritabanını Docker ile başlat (Bağımlılık: R-001)
- [x] R-003 - Backend bağımlılıklarını `.venv` içine yükle (Bağımlılık: yok)
- [x] R-004 - Veritabanı migrasyonlarını çalıştır (Bağımlılık: R-002, R-003)
- [x] R-005 - Backend sunucusunu başlat (Bağımlılık: R-004)
- [x] R-006 - Mobil bağımlılıklarını (`npm install`) yükle (Bağımlılık: yok)
- [x] R-007 - Mobil uygulamayı başlat (Bağımlılık: R-006)
- [x] R-008 - Yeni başlayanlar için kurulum rehberi oluştur (docs/kurulum_rehberi.md)
